<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="
    http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">


    <!-- PostgreSQL: convert to TEXT -->
    <changeSet id="1-change-field-length" author="francis">
        <preConditions onFail="MARK_RAN">
            <dbms type="postgresql"/>
        </preConditions>

        <sql>
            ALTER TABLE psso_device
            ALTER COLUMN signing_key_id TYPE TEXT,
        ALTER COLUMN encryption_key_id TYPE TEXT;
        </sql>
    </changeSet>


    <!-- MariaDB: increase VARCHAR size -->
    <changeSet id="7-key-id-to-varchar-512-mariadb" author="francis">
        <preConditions onFail="MARK_RAN">
            <dbms type="mariadb"/>
        </preConditions>

        <sql>
            ALTER TABLE psso_device
                MODIFY COLUMN signing_key_id VARCHAR(512),
                MODIFY COLUMN encryption_key_id VARCHAR(512);
        </sql>
    </changeSet>

</databaseChangeLog>
